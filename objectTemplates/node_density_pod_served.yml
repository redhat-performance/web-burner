---
apiVersion: v1
kind: Pod
metadata:
  name: pod-served-{{ .Replica }}
  labels:
    app: pod-served-{{ .Replica }}
    ns: served-ns-{{ .Replica }}
spec:
  containers:
  - name: perfapp-1
    image: quay.io/openshift-scale/nginx
    imagePullPolicy: IfNotPresent
    livenessProbe:
      httpGet:
        path: /
        port: 8080
      periodSeconds: 30
      failureThreshold: 1
      timeoutSeconds: 15
      initialDelaySeconds: 5
    resources:
      request:
        memory: '100Mi'
        cpu: 100m
      limit:
        memory: '100Mi'
        cpu: 100m          
    ports:
    - containerPort: 8080        
  - args:
    - sleep
    - infinity
    name: app
    image: quay.io/centos/centos
    imagePullPolicy: IfNotPresent
    readinessProbe:
      exec:
        command:
        - ping
        - -c1
        - 172.18.0.10
    resources:
      request:
        memory: '100Mi'
        cpu: 100m
      limit:
        memory: '100Mi'
        cpu: 100m    
      #  nodeSelector:
      #     kubernetes.io/hostname: worker{{if eq .Iteration 81}}{{printf "%03d" (add .Iteration 2)}}{{else if eq .Iteration 82}}{{printf "%03d" (add .Iteration 1)}}{{else if eq .Iteration 98}}{{printf "%03d" (add .Iteration 2)}}{{else if eq .Iteration 110}}{{printf "%03d" (add .Iteration 2)}}{{else}}{{printf "%03d" (add .Iteration 3)}}{{end}}-r640   
     
     
